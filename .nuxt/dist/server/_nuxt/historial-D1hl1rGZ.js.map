{"version":3,"file":"historial-D1hl1rGZ.js","sources":["../../../../pages/historial.vue"],"sourcesContent":["<template>\r\n  <button\r\n    @click=\"$router.push('/menu')\"\r\n    class=\"bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded transition m-5\"\r\n  >\r\n    Volver a p√°gina principal\r\n  </button>\r\n\r\n  <main class=\"max-w-3xl mx-auto p-8 bg-gray-900 rounded-lg shadow-lg text-gray-300 min-h-[400px]\">\r\n    <h1 class=\"text-3xl font-semibold mb-6 text-gray-200 text-center\">Historial de Formularios</h1>\r\n\r\n    <div v-if=\"loading\" class=\"text-center text-gray-400\">Cargando formularios...</div>\r\n\r\n    <div v-else-if=\"formularios.length === 0\" class=\"text-center text-gray-400\">\r\n      No hay historiales disponibles por ahora.\r\n    </div>\r\n\r\n    <div v-else class=\"space-y-4\">\r\n      <div\r\n        v-for=\"form in formularios\"\r\n        :key=\"form.id\"\r\n        class=\"border border-gray-700 bg-gray-800 rounded-lg p-4 hover:shadow-lg transition cursor-pointer\"\r\n        @click=\"verFormulario(form.id)\"\r\n      >\r\n        <h2 class=\"text-xl font-bold text-gray-100\">{{ form.name }}</h2>\r\n        <p class=\"text-sm text-gray-400\">Fecha: {{ formatDate(form.createdAt) }}</p>\r\n        <p class=\"text-md font-semibold text-green-300 mt-2\">\r\n          Total Final: ${{ form.resumenFinanciero?.totalFinal ? Math.round(form.resumenFinanciero.totalFinal) : 0 }}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  </main>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { collection, getDocs, orderBy, query } from 'firebase/firestore'\r\nimport { db } from '~/firebase/firebase'\r\nimport { useRouter } from 'vue-router'\r\n\r\nconst router = useRouter()\r\nconst formularios = ref([])\r\nconst loading = ref(true)\r\n\r\nfunction formatDate(timestamp) {\r\n  if (!timestamp?.toDate) return 'Fecha desconocida'\r\n  const date = timestamp.toDate()\r\n  return date.toLocaleDateString('es-CL', {\r\n    day: '2-digit',\r\n    month: '2-digit',\r\n    year: 'numeric'\r\n  })\r\n}\r\n\r\nfunction verFormulario(id) {\r\n  router.push(`/verformulario/${id}`)\r\n}\r\n\r\nonMounted(async () => {\r\n  try {\r\n    const q = query(collection(db, 'formularios'), orderBy('createdAt', 'desc'))\r\n    const querySnapshot = await getDocs(q)\r\n    formularios.value = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))\r\n  } catch (err) {\r\n    console.error('Error al cargar formularios:', err)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n})\r\n</script>\r\n"],"names":["_ssrRenderList","_ssrInterpolate"],"mappings":";;;;;;;;;;AAwCe,cAAS;AACxB,UAAM,cAAc,IAAI,EAAE;AAC1B,UAAM,UAAU,IAAI,IAAI;AAExB,aAAS,WAAW,WAAW;AAC7B,UAAI,EAAC,uCAAW,QAAQ,QAAO;AAC/B,YAAM,OAAO,UAAU,OAAM;AAC7B,aAAO,KAAK,mBAAmB,SAAS;AAAA,QACtC,KAAK;AAAA,QACL,OAAO;AAAA,QACP,MAAM;AAAA,MACV,CAAG;AAAA,IACH;;;UAzCe,QAAA,OAAO;;MAEF,WAAA,YAAA,MAAY,WAAM,GAAA;;;;AAMfA,sBAAA,YAAA,QAAR,SAAI;;wKAKoCC,eAAA,KAAK,IAAI,gEACb,WAAW,KAAK,SAAS,CAAA,4EAEjDA,iBAAA,UAAK,sBAAL,mBAAwB,cAAa,KAAK,MAAM,KAAK,kBAAkB,UAAU,IAAA,CAAA;;;;;;;;;;;;;;"}